<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://viewer-akamai-us-4.qa.sarine.com/qa4/content/viewers/atomic/v1/assets/sarine.plugin.imgplayer.min.css"
    />
  </head>
  <body>
    <h1 id="title"></h1>
    <div id="imageplayer"></div>

    <div id="network"></div>
    <div id="performance">Loading...</div>
    <button id="switchBtn" onclick="switchPage()" style="display: none;"></button>
    <div id="log"></div>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://viewer-akamai-us-4.qa.sarine.com/qa4/content/viewers/atomic/v1/assets/sarine.plugin.imgplayer.min.js"></script>
    <script src="assets/measure.performance.js"></script>

    <script type="text/javascript">
      let isH2 = location.search.includes('http2');

      document.getElementById('title').innerHTML = isH2 ? 'Load 272 images via HTTP/2' : 'Load 272 images via HTTP/1.1';
      document.getElementById('switchBtn').innerHTML = isH2 ? 'Switch to HTTP/1.1' : 'Switch to HTTP/2';

      $(document).ready(function() {
        const url =
          (isH2 ? 'https' : 'http') +
          '://viewer-akamai-us-4.qa.sarine.com/qa4/alexs/imgoptim_demo/400x400_jpeg_75/img{num}.jpg?rand=' +
          Math.random();

        $('#imageplayer')
          .empty()
          .imgplay({
            totalImages: 272,
            imageName: 'img{num}.jpg',
            urlDir: url,
            rate: 30,
            height: 320,
            width: 320,
            autoPlay: true
          });
      });

      const switchPage = () => (location.href = location.href.replace('?http2', '') + (isH2 ? '' : '?http2'));

    </script>
  </body>
</html>
